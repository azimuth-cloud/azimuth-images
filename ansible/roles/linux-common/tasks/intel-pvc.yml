
---
- name: Install dependencies
  ansible.builtin.apt:
    update_cache: true
    pkg:
      - gpg-agent
      - wget
      - linux-headers-generic
      - linux-image-generic
    state: latest

- name: Add an Apt signing key, uses whichever key is at the URL
  ansible.builtin.apt_key:
    url: https://repositories.intel.com/gpu/intel-graphics.key
    state: present

- name: Enable Intel PVC repository (non-lts)
  ansible.builtin.apt_repository:
    repo: "deb https://repositories.intel.com/gpu/ubuntu {{ ansible_distribution_release }}/lts/2350 unified"
    state: present

- name: Install PVC packages
  ansible.builtin.apt:
    update_cache: true
    pkg:
      - linux-headers-generic
      - linux-image-generic
      - intel-i915-dkms
      - intel-fw-gpu
      - flex
      - bison
      - xpu-smi
    state: present
